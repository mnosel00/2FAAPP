div class="container">
  <h2>Resetowanie hasła</h2>
  <p>Użyj tej formy, aby zresetować hasło przy użyciu kodu z aplikacji uwierzytelniającej.</p>

  <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" novalidate>
    <!-- Email -->
    <div class="form-group mb-3">
      <label for="email">Adres Email</label>
      <input type="email" id="email" class="form-control" formControlName="email">
      <div *ngIf="resetForm.get('email')?.invalid && resetForm.get('email')?.touched" class="text-danger mt-1">
        <small *ngIf="resetForm.get('email')?.errors?.['required']">Email jest wymagany.</small>
        <small *ngIf="resetForm.get('email')?.errors?.['email']">Nieprawidłowy format email.</small>
      </div>
    </div>

    <!-- Nowe hasło -->
    <div class="form-group mb-3">
      <label for="newPassword">Nowe hasło</label>
      <input type="password" id="newPassword" class="form-control" formControlName="newPassword">
      <div *ngIf="resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched" class="text-danger mt-1">
        <small *ngIf="resetForm.get('newPassword')?.errors?.['required']">Nowe hasło jest wymagane.</small>
        <small *ngIf="resetForm.get('newPassword')?.errors?.['minlength']">Hasło musi mieć co najmniej 8 znaków.</small>
        <small *ngIf="resetForm.get('newPassword')?.errors?.['pattern']">Hasło musi zawierać dużą i małą literę, cyfrę oraz znak specjalny.</small>
      </div>
    </div>

    <!-- Potwierdź nowe hasło -->
    <div class="form-group mb-3">
      <label for="confirmNewPassword">Potwierdź nowe hasło</label>
      <input type="password" id="confirmNewPassword" class="form-control" formControlName="confirmNewPassword">
      <div *ngIf="resetForm.errors?.['passwordsMismatch'] && resetForm.get('confirmNewPassword')?.touched" class="text-danger mt-1">
        <small>Hasła nie są zgodne.</small>
      </div>
    </div>

    <!-- Kod z aplikacji (na końcu) -->
    <div class="form-group mb-3">
      <label for="token">Kod z aplikacji Authenticator</label>
      <input type="text" id="token" class="form-control" formControlName="token" maxlength="6">
      <div *ngIf="resetForm.get('token')?.invalid && resetForm.get('token')?.touched" class="text-danger mt-1">
        <small *ngIf="resetForm.get('token')?.errors?.['required']">Kod jest wymagany.</small>
      </div>
    </div>

    <button type="submit" [disabled]="resetForm.invalid" class="btn btn-primary">Zresetuj hasło</button>
  </form>

  <div *ngIf="successMessage" class="alert alert-success mt-3">{{ successMessage }}</div>
  <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>

  <div class="text-center mt-3">
    <a routerLink="/login">Powrót do logowania</a>
  </div>
</div>